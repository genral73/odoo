<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve">

    <t t-name="mail.component.ComposerTextInput" owl="1">
        <div class="o_ComposerTextInput">
            <div class="dropup o_ComposerTextInput_mention_dropdown">
                <div class="dropdown-menu o_mention_proposition_list" t-ref="mention_dropdown" t-att-class="{ 'show': state.isMentionsOpen }">
                    <t t-if="state.mentionSuggestions[0]" >
                        <t t-foreach="state.mentionSuggestions[0]" t-as="mention" t-key="mention.id">
                            <div role="separator" t-if="mention.divider" class="dropdown-divider"/>
                            <a class="dropdown-item o_mention_proposition" t-att-class="{ 'active': mention.id === state.active_id }" href="#" role="menuitem"
                               t-att-data-id="mention.id" t-on-click="_onClickMentionItem" t-on-mouseover="_onMouseOverMention">
                                <span t-att-class="mention.id ? 'o_mention_updatable_im_status' : ''" t-att-data-partner-id="mention.id">
                                    <i t-if="mention.im_status == 'online'" class="o_mail_user_status o_user_online fa fa-circle" title="Online" role="img" aria-label="User is online"/>
                                    <i t-if="mention.im_status == 'away'" class="o_mail_user_status o_user_idle fa fa-circle" title="Idle" role="img" aria-label="User is idle"/>
                                    <i t-if="mention.im_status == 'offline'" class="o_mail_user_status fa fa-circle-o" title="Offline" role="img" aria-label="User is offline"/>
                                </span>
                                <span class="o_mention_name"><t t-esc="mention.name"/></span>
                                <t t-if="mention.email">
                                    <span class="o_mention_info">(<t t-esc="mention.email"/>)</span>
                                </t>
                            </a>
                        </t>
                    </t>
                </div>
            </div>
            <textarea class="o_ComposerTextInput_textarea" t-esc="storeProps.composer.textInputContent" placeholder="Write something..." t-on-keydown="_onKeydownTextarea" t-on-keyup="_onKeyupTextarea" t-on-input="_onInputTextarea" t-ref="textarea" />
        </div>
    </t>

    <!--
        @param {boolean} isMobile
        @param {Object} item
        @param {Object} item.original data related to mentioned canned response
        @param {string} item.original.source source of the mentioned canned response
        @param {string} item.original.substitution substitution string of the mentioned canned response
    -->
    <t t-name="mail.component.ComposerTextInput.CannedMentionMenuItem" owl="1">
        <div class="o_ComposerTextInput_mentionMenuItem" t-att-class="{ 'o-mobile': isMobile }" t-att-title="item.original.source">
            <t t-esc="item.original.source"/> <span class="o_extra"><t t-esc="item.original.substitution"/></span>
        </div>
    </t>

    <!--
        @param {boolean} isMobile
        @param {Object} item
        @param {string} item.string name of the mentioned channel
    -->
    <t t-name="mail.component.ComposerTextInput.ChannelMentionMenuItem" owl="1">
        <div class="o_ComposerTextInput_mentionMenuItem" t-att-class="{ 'o-mobile': isMobile }">
            <t t-esc="item.string"/>
        </div>
    </t>

    <!--
        Attributes 'data-oe-id' and 'data-oe-model' are considered safe by html_sanitizer.
        @param {Object} item
        @param {Object} item.original data related to mentioned channel
        @param {integer} item.original.id id of the mentioned channel
        @param {string} item.original.name name of the mentioned channel
    -->
    <t t-name="mail.component.ComposerTextInput.ChannelMentionSelectItem" owl="1">
        <a href="#" class="o_mention" contenteditable="false" data-oe-model="mail.channel" t-att-data-oe-id="item.original.id">#<t t-esc="item.original.name"/></a>
    </t>

    <!--
        @param {boolean} isMobile
        @param {Object} item
        @param {Object} item.original data related to mentioned command
        @param {string} item.original.help help string of the mentioned command
        @param {string} item.original.name name of the mentioned command
    -->
    <t t-name="mail.component.ComposerTextInput.CommandMentionMenuItem" owl="1">
        <div class="o_ComposerTextInput_mentionMenuItem" t-att-class="{ 'o-mobile': isMobile }" t-att-title="item.original.name">
            <t t-esc="item.original.name"/> <span class="o_extra"><t t-esc="item.original.help"/></span>
        </div>
    </t>

    <!--
        @param {boolean} isMobile
        @param {Object} item
        @param {Object} item.original data related to mentioned partner
        @param {string} item.original.email email of the mentioned partner
        @param {string} partnerName name of the mentioned partner
    -->
    <t t-name="mail.component.ComposerTextInput.PartnerMentionMenuItem" owl="1">
        <div class="o_ComposerTextInput_mentionMenuItem" t-att-class="{ 'o-mobile': isMobile }" t-attf-title="{{ partnerName }}{{ item.original.email ? ('&lt;' + item.original.email + '&gt;') : ''}}">
            <t t-if="item.original.im_status">
                <t t-call="mail.component.PartnerImStatusIcon">
                    <t t-set="storeProps" t-value="{ partner: item.original }"/>
                </t>
            </t><t t-esc="partnerName"/><t t-if="item.original.email"> <t t-esc="item.original.email"/><span class="o_extra"><t t-esc="'&lt;' + item.original.email + '&gt;'"/></span></t>
        </div>
    </t>

    <!--
        Attributes 'data-oe-id' and 'data-oe-model' are considered safe by html_sanitizer.
        @param {Object} item
        @param {Object} item.original data related to mentioned partner
        @param {integer} item.original.id id of the mentioned partner
        @param {string} partnerName name of the mentioned partner
    -->
    <t t-name="mail.component.ComposerTextInput.PartnerMentionSelectItem" owl="1">
        <a href="#" class="o_mention" contenteditable="false" data-oe-model="res.partner" t-att-data-oe-id="item.original.id">@<t t-esc="partnerName"/></a>
    </t>

</templates>
