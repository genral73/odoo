<?xml version="1.0" encoding="UTF-8"?>
<templates id="template" xml:space="preserve">

    <t t-name="Chrome" owl="1">
        <div class="pos-receipt-print"></div>

        <div class="pos" t-on-pos-error="onPosError" t-on-toggle-debug-widget="onToggleDebugWidget">
            <t t-if="state.isReady">
                <div class="pos-topheader">
                    <div class="pos-branding">
                        <img class="pos-logo" t-on-click="onToggleDebugWidget"
                             src="/point_of_sale/static/src/img/logo.png" alt="Logo" />
                    </div>
                    <div class="pos-rightheader">
                        <OrderSelector />
                        <CashierName />
                        <!-- <SaleDetailsButton t-if="env.pos.proxy.printer" /> -->
                        <ProxyStatus t-if="env.pos.config.use_proxy" />
                        <!-- <ClientScreen t-if="env.pos.config.use_proxy" /> -->
                        <SyncNotification />
                        <HeaderButton gui="gui" />
                    </div>
                </div>
                <div class="pos-content">
                    <div class="window">
                        <div class="subwindow">
                            <div class="subwindow-container">
                                <div class="subwindow-container-fix screens">
                                    <t t-if="state.activeScreenName" t-component="screenComponent"
                                       t-props="screenProps" t-on-show-screen="showScreen"
                                       t-key="state.activeScreenName" />
                                </div>
                            </div>
                        </div>
                    </div>
                    <DebugWidget t-if="env.isDebug()" gui="gui"
                                 isShown="state.isDebugWidgetShown" />
                </div>
                <div id="popups" class="popups"></div>
            </t>

            <div class="loader">
                <div class="loader-feedback oe_hidden">
                    <h1 class="message">Loading</h1>
                    <div class="progressbar">
                        <div class="progress" width="50%"></div>
                    </div>
                    <div class="oe_hidden button skip">
                        Skip
                    </div>
                </div>
            </div>
        </div>
    </t>

    <t t-name="PosCloseWarning">
        <div>There are pending operations that could not be saved into the database, are you sure
            you want to exit?</div>
    </t>

    <t t-name="ActionButtonWidget">
        <div class='control-button'>
            <t t-esc='widget.label' />
        </div>
    </t>

    <t t-name="SetFiscalPositionButton">
        <div class='control-button o_fiscal_position_button'>
            <i class='fa fa-book' role="img" aria-label="Set fiscal position"
               title="Set fiscal position" />
            <t t-esc='widget.get_current_fiscal_position_name()' />
        </div>
    </t>

    <t t-name="SetPricelistButton">
        <div class='control-button o_pricelist_button'>
            <i class='fa fa-th-list' role="img" aria-label="Price list" title="Price list" />
            <t t-esc='widget.get_current_pricelist_name()' />
        </div>
    </t>

    <t t-name="ScaleScreenWidget">
        <div class="scale-screen screen">
            <div class="screen-content">
                <div class="top-content">
                    <span class='button back'>
                        <i class='fa fa-angle-double-left'></i>
                        Back
                    </span>
                    <h1 class='product-name'>
                        <t t-esc="widget.get_product_name()" />
                    </h1>
                </div>
                <div class="centered-content">
                    <div class='weight js-weight'>
                        <t t-esc="widget.get_product_weight_string()" />
                    </div>
                    <div class='product-price'>
                        <t
                           t-esc="widget.format_currency(widget.get_product_price()) + '/' + widget.get_product_uom()" />
                    </div>
                    <div class='computed-price'>
                        123.14 â‚¬
                    </div>
                    <div class='buy-product'>
                        Order
                        <i class='fa fa-angle-double-right'></i>
                    </div>
                </div>
            </div>
        </div>
    </t>

    <t t-name="SyncErrorPopupWidget">
        <div role="dialog" class="modal-dialog">
            <div class="popup popup-error">
                <header class="title">
                    <t t-esc=" widget.options.title || 'Error' " />
                </header>
                <main class="body traceback">
                    <t t-esc=" widget.options.body || '' " />
                </main>
                <footer class="footer">
                    <div class="button cancel">
                        Ok
                    </div>
                    <div class="button stop_showing_sync_errors">
                        Don't show again
                    </div>
                </footer>
            </div>
        </div>
    </t>

    <t t-name="ErrorBarcodePopupWidget">
        <div role="dialog" class="modal-dialog">
            <div class="popup popup-barcode">
                <header class="title">Unknown Barcode
                    <br />
                    <span class='barcode'>
                        <t t-esc="widget.options.barcode" /></span>
                </header>
                <main class="body">
                    The Point of Sale could not find any product, client, employee
                    or action associated with the scanned barcode.
                </main>
                <footer class="footer">
                    <div class="button cancel">
                        Ok
                    </div>
                </footer>
            </div>
        </div>
    </t>

    <t t-name="TextAreaPopupWidget">
        <div role="dialog" class="modal-dialog">
            <div class="popup popup-textinput">
                <header class="title">
                    <t t-esc=" widget.options.title || '' " />
                </header>
                <textarea><t t-esc="widget.options.value" /></textarea>
                <footer class="footer">
                    <div class="button confirm">
                        Ok
                    </div>
                    <div class="button cancel">
                        Cancel
                    </div>
                </footer>
            </div>
        </div>
    </t>

    <t t-name="SelectionPopupWidget">
        <div role="dialog" class="modal-dialog">
            <div class="popup popup-selection">
                <header class="title">
                    <t t-esc=" widget.options.title || 'Select' " />
                </header>
                <div class='selection scrollable-y touch-scrollable'>
                    <t t-foreach="widget.list || []" t-as="item">
                        <div t-attf-class="selection-item {{ widget.is_selected.call(widget, item.item) ? 'selected' : '' }}"
                             t-att-data-item-index='item_index'>
                            <t t-esc='item.label' />
                        </div>
                    </t>
                </div>
                <footer class="footer">
                    <div class="button cancel">
                        Cancel
                    </div>
                </footer>
            </div>
        </div>
    </t>

    <t t-name="NumberPopupWidget">
        <div role="dialog" class="modal-dialog">
            <div class="popup popup-number">
                <header class="title">
                    <t t-esc=" widget.options.title || '' " />
                </header>
                <div class='popup-input value active'>
                    <t t-esc='widget.inputbuffer' />
                </div>
                <div class='popup-numpad'>
                    <button class="input-button number-char" data-action='1'>1</button>
                    <button class="input-button number-char" data-action='2'>2</button>
                    <button class="input-button number-char" data-action='3'>3</button>
                    <t t-if="widget.options.cheap">
                        <button class="mode-button add" data-action='+1'>+1</button>
                    </t>
                    <t t-if="!widget.options.cheap">
                        <button class="mode-button add" data-action='+10'>+10</button>
                    </t>
                    <br />
                    <button class="input-button number-char" data-action='4'>4</button>
                    <button class="input-button number-char" data-action='5'>5</button>
                    <button class="input-button number-char" data-action='6'>6</button>
                    <t t-if="widget.options.cheap">
                        <button class="mode-button add" data-action='+2'>+2</button>
                    </t>
                    <t t-if="!widget.options.cheap">
                        <button class="mode-button add" data-action='+20'>+20</button>
                    </t>
                    <br />
                    <button class="input-button number-char" data-action='7'>7</button>
                    <button class="input-button number-char" data-action='8'>8</button>
                    <button class="input-button number-char" data-action='9'>9</button>
                    <t t-if="widget.options.cheap">
                        <button class="mode-button add" data-action='+5'>+5</button>
                    </t>
                    <t t-if="!widget.options.cheap">
                        <button class="mode-button add" data-action='+50'>+50</button>
                    </t>
                    <br />
                    <button class="input-button numpad-char" data-action='CLEAR'>C</button>
                    <button class="input-button number-char" data-action='0'>0</button>
                    <button class="input-button number-char dot"
                            t-att-data-action='widget.decimal_separator'>
                        <t t-esc='widget.decimal_separator' /></button>
                    <button class="input-button numpad-backspace" data-action='BACKSPACE'>
                        <img style="pointer-events: none;"
                             src="/point_of_sale/static/src/img/backspace.png" width="24"
                             height="21" alt="Backspace" />
                    </button>
                    <br />
                </div>
                <footer class="footer centered">
                    <div class="button cancel">
                        Cancel
                    </div>
                    <div class="button confirm">
                        Ok
                    </div>
                </footer>
            </div>
        </div>
    </t>

    <t t-name="OrderImportPopupWidget">
        <div role="dialog" class="modal-dialog">
            <div class="popup popup-import">
                <header class="title">Finished Importing Orders</header>
                <t t-if="widget.options and widget.options.report">
                    <t t-set="report" t-value="widget.options.report" />
                    <t t-set="unpaid_skipped"
                       t-value="(report.unpaid_skipped_existing || 0) + (report.unpaid_skipped_session || 0)" />
                    <ul class='body'>
                        <li>Successfully imported <b>
                                <t t-esc='report.paid || 0' /></b> paid orders</li>
                        <li>Successfully imported <b>
                                <t t-esc='report.unpaid || 0' /></b> unpaid orders</li>
                        <t t-if="unpaid_skipped">
                            <li><b>
                                    <t t-esc="unpaid_skipped" /></b> unpaid orders could not be
                                imported
                                <ul>
                                    <li><b>
                                            <t t-esc="report.unpaid_skipped_existing || 0" /></b>
                                        were duplicates of existing orders</li>
                                    <li><b>
                                            <t t-esc="report.unpaid_skipped_session || 0" /></b>
                                        belong to another session:
                                        <t t-if="report.unpaid_skipped_sessions">
                                            <ul>
                                                <li>Session ids: <b>
                                                        <t
                                                           t-esc="JSON.stringify(report.unpaid_skipped_sessions)" />
                                                        </b></li>
                                            </ul>
                                        </t>
                                    </li>

                                </ul>
                            </li>
                        </t>
                    </ul>
                </t>
                <footer class="footer">
                    <div class="button cancel">
                        Ok
                    </div>
                </footer>
            </div>
        </div>
    </t>

    <!-- TODO jcb Unused? -->
    <t t-name="Paymentline">
        <div t-attf-class="paymentline #{line.selected ? 'selected' : ''}">
            <div class='paymentline-name'>
                <t t-esc="line.payment_method.name" />
            </div>
            <input class='paymentline-input'
                   t-att-type="widget.decimal_point === '.' ? 'number' : 'text'"
                   t-attf-pattern="[0-9]+([\\#{widget.decimal_point || '.' }][0-9]+)?" step="0.01"
                   t-att-value="line.get_amount_str()" />
            <span class='paymentline-delete'>
                <img src="/point_of_sale/static/src/img/search_reset.gif" alt="Delete" />
            </span>
        </div>
    </t>

    <t t-name="CustomerFacingDisplayHead">
        <div class="resources">
            <base t-att-href="origin" />
            <link href="/point_of_sale/static/src/css/customer_facing_display.css"
                  rel="stylesheet" />
            <script type="text/javascript">
                // This function needs to be named that way, call it the foreign JS API
                // The iotbox will execute it, with the behavior intended
                function foreign_js() {
                    if ($('.pos-adv').hasClass('pos-hidden')) {
                        $('.pos-customer_facing_display').addClass('pos-js_no_ADV');
                    }
                    $(window).on('resize', function () {
                        $('.pos-customer_facing_display').toggleClass('pos-js_no_ADV', $('.pos-adv').hasClass('pos-hidden'));
                    }).trigger('resize');
                };
            </script>
        </div>
    </t>

    <t t-name="CustomerFacingDisplayOrderLines">
        <t t-foreach="orderlines" t-as="orderline">
            <div class="pos_orderlines_item">
                <div>
                    <div t-attf-style="background-image:url(#{orderline.product.image_base64})" />
                </div>
                <div>
                    <t t-esc="orderline.product.display_name" />
                </div>
                <div>
                    <t t-esc="orderline.get_quantity_str()" />
                </div>
                <div>
                    <t t-esc="pos.format_currency(orderline.get_display_price())" />
                </div>
            </div>
        </t>
    </t>

    <t t-name="CustomerFacingDisplayPaymentLines">
        <t t-foreach="order.get_paymentlines()" t-as="paymentline">
            <div>
                <span>
                    <t t-esc="paymentline.name" /></span>
            </div>
            <div>
                <span>
                    <t t-esc="pos.format_currency(paymentline.get_amount())" /></span>
            </div>
        </t>
        <t t-if="order.get_paymentlines().length > 0">
            <div>
                <span class="pos-change_title">Change:</span>
            </div>
            <div>
                <span class="pos-change_amount">
                    <t t-esc="pos.format_currency(order.get_change())" /></span>
            </div>
        </t>
    </t>
</templates>
